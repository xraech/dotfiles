#!/bin/dash

# Theme options

curr_theme="$(cat $HOME/.Xresources | grep themes | cut -d/ -f 6 | cut -d\" -f 1)"
echo $curr_theme
themes="$(ls $HOME/.config/themes/ | menu -p Themes:)"

sed -i 's/'$curr_theme'/'$themes'/' $HOME/.Xresources
xrdb "$HOME/.Xresources"


# bspwm borders
bspwm="$HOME/.config/bin/bspwm/borders"

inner1=$(get_xres "color14" | sed 's/#/0x/')
inner2=$(get_xres "foreground" | sed 's/#/0x/')
outer=$(get_xres "background" | sed 's/#/0x/')

foreground=$(get_xres "foreground")
background=$(get_xres "background")
focused=$(get_xres "color1")

sed -i "s/inner1=.*/inner1='$inner1'/" $bspwm
sed -i "s/inner2=.*/inner2='$inner2'/" $bspwm
sed -i "s/outer=.*/outer='$outer'/" $bspwm
sed -i '28s/".*/"'$foreground'\"/' "$HOME/.config/bspwm/bspwmrc"
sed -i '29s/".*/"'$focused'\"/' "$HOME/.config/bspwm/bspwmrc"
bspc config normal_border_color $background
bspc config focused_border_color $background

# Vim
#if test $curr_theme = 'FlaredSky'
#	sed -i '9s/set/"\ set/' $HOME/.vimrc
#	sed -i '10s/colorscheme/"\ colorscheme/' $HOME/.vimrc
#else
#	sed -i '9s/"\ set/"set/' $HOME/.vimrc
#	sed -i '10s/"\ colorscheme/"colorscheme/' $HOME/.vimrc
#end

# Icons
icon_path=$HOME/.config/bin/icons
for f in $icon_path/*.svg; do
    sed -i "s/:#....../:'$focused'/g" $f
done

# Dunst
sed -i 's/background =.*/background = \"'$background'\"/' $HOME/.config/dunst/dunstrc
sed -i 's/frame_color =.*/frame_color = \"'$focused'\"/' $HOME/.config/dunst/dunstrc
sed -i 's/foreground =.*/foreground = \"'$foreground'\"/' $HOME/.config/dunst/dunstrc
# urgency critical, invert colors
sed -i '60s/background =.*/background = \"'$foreground'\"/' $HOME/.config/dunst/dunstrc
sed -i '61s/foreground =.*/foreground = \"'$background'\"/' $HOME/.config/dunst/dunstrc

# GTK theme
sed -i '2s/=.*/='$themes'/' $HOME/.config/gtk-3.0/settings.ini
sed -i '5s/=.*/=\"'$themes'\"/' $HOME/.gtkrc-2.0

# Disable & Enable programs
pkill -9 dunst && dunst &
bspc config normal_border_color $foreground
bspc config focused_border_color $focused
# pkill -9 borders && exec borders &

# vim: set ft=sh :
